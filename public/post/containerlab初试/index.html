<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Containerlab基础使用 - </title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="inksnw" /><meta name="description" content="基本概念 Containerlab根据用户传递给它的拓扑信息来建立实验,构建网络交换和路由, 是一个很方便的学习工具 安装 官方文档(https:/" /><meta name="keywords" content="Hugo, theme, even" />


<meta name="robots" content="">






<meta name="generator" content="Hugo 0.124.1 with theme even" />


<link rel="canonical" href="http://inksnw.asuscomm.com:3001/post/containerlab%E5%88%9D%E8%AF%95/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.64c9b7f0254ed1aa365dc8e9acbb5c7241025dced4946314569cf2cc3d7aa917.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"  crossorigin="anonymous">
<link rel="stylesheet" href="/css/styles.css">


<meta property="og:title" content="Containerlab基础使用" />
<meta property="og:description" content="基本概念 Containerlab根据用户传递给它的拓扑信息来建立实验,构建网络交换和路由, 是一个很方便的学习工具 安装 官方文档(https:/" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://inksnw.asuscomm.com:3001/post/containerlab%E5%88%9D%E8%AF%95/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-12-30T10:06:06+08:00" />
<meta property="article:modified_time" content="2023-12-30T10:06:06+08:00" />
<meta itemprop="name" content="Containerlab基础使用">
<meta itemprop="description" content="基本概念 Containerlab根据用户传递给它的拓扑信息来建立实验,构建网络交换和路由, 是一个很方便的学习工具 安装 官方文档(https:/"><meta itemprop="datePublished" content="2023-12-30T10:06:06+08:00" />
<meta itemprop="dateModified" content="2023-12-30T10:06:06+08:00" />
<meta itemprop="wordCount" content="2702">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Containerlab基础使用"/>
<meta name="twitter:description" content="基本概念 Containerlab根据用户传递给它的拓扑信息来建立实验,构建网络交换和路由, 是一个很方便的学习工具 安装 官方文档(https:/"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo"></a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/rust/">
        <li class="mobile-menu-item">rust</li>
      </a><a href="/life/">
        <li class="mobile-menu-item">生活</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo"></a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/rust/">rust</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/life/">生活</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    

    <header class="post-header">
        <h1 class="post-title">Containerlab基础使用</h1>

        <div class="post-meta">
            <span class="post-time"> 2023-12-30 </span>
            
            <span class="more-meta"> 约 2702 字 更新于 2023-12-30
              </span>
            
        </div>
    </header>

    
<div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">目录</h2>
    <div class="post-toc-content always-active">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#基本概念">基本概念</a></li>
            <li><a href="#安装">安装</a></li>
            <li><a href="#veth直连">veth直连</a></li>
            <li><a href="#网桥连接">网桥连接</a></li>
            <li><a href="#路由连接">路由连接</a></li>
            <li><a href="#vxlan">vxlan</a></li>
            <li><a href="#host-gw">Host-gw</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

    
    <div class="post-content">
        <h3 id="基本概念">基本概念</h3>
<p>Containerlab根据用户传递给它的拓扑信息来建立实验,构建网络交换和路由, 是一个很方便的学习工具</p>
<h3 id="安装">安装</h3>
<p>官方文档(<a href="https://containerlab.dev/quickstart/">https://containerlab.dev/quickstart/</a>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">bash -c &#34;$(curl -sL https://get.containerlab.dev)&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="veth直连">veth直连</h3>
<p>定义拓扑文件, 创建clab执行脚本</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">set</span> -v
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;clab.yaml | clab deploy -t clab.yaml -
</span></span></span><span class="line"><span class="cl"><span class="s">name: veth
</span></span></span><span class="line"><span class="cl"><span class="s">topology:
</span></span></span><span class="line"><span class="cl"><span class="s">  nodes:
</span></span></span><span class="line"><span class="cl"><span class="s">    server1:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">    server2:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.11/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">  links:
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;server1:net0&#34;,&#34;server2:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@node4:~# clab inspect -a
</span></span><span class="line"><span class="cl">+---+-----------+----------+-------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="c1"># | Topo Path | Lab Name |       Name        | Container ID |       Image       | Kind  |  State  |  IPv4 Address  |     IPv6 Address     |</span>
</span></span><span class="line"><span class="cl">+---+-----------+----------+-------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">1</span> <span class="p">|</span> clab.yaml <span class="p">|</span> veth     <span class="p">|</span> clab-veth-server1 <span class="p">|</span> 66a991710bdc <span class="p">|</span> nicolaka/netshoot <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.3/24 <span class="p">|</span> 2001:172:20:20::3/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">2</span> <span class="p">|</span>           <span class="p">|</span>          <span class="p">|</span> clab-veth-server2 <span class="p">|</span> 2cdfbebe238f <span class="p">|</span> nicolaka/netshoot <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.2/24 <span class="p">|</span> 2001:172:20:20::2/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---+-----------+----------+-------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>销毁</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">clab destroy -t clab.yaml 
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Parsing <span class="p">&amp;</span> checking topology file: clab.yaml  
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Destroying lab: veth                         
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Removed container: clab-veth-server2         
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Removed container: clab-veth-server1         
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Removing containerlab host entries from /etc/hosts file 
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Removing ssh config <span class="k">for</span> containerlab nodes   
</span></span><span class="line"><span class="cl">root@node4:~# clab inspect -a
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> no containers found 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="网桥连接">网桥连接</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">set</span> -v
</span></span><span class="line"><span class="cl">brctl addbr  br-pool0
</span></span><span class="line"><span class="cl">ifconfig br-pool0 up
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;br.yaml | clab deploy -t br.yaml -
</span></span></span><span class="line"><span class="cl"><span class="s">name: bridge
</span></span></span><span class="line"><span class="cl"><span class="s">topology: 
</span></span></span><span class="line"><span class="cl"><span class="s">  nodes:
</span></span></span><span class="line"><span class="cl"><span class="s">    br-pool0:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: bridge
</span></span></span><span class="line"><span class="cl"><span class="s">    server1:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">    server2:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec: 
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.11/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">  links: 
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;br-pool0:eth1&#34;, &#34;server1:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;br-pool0:eth2&#34;, &#34;server2:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker exec -it cfeaba2f8bb2  /bin/bash
</span></span><span class="line"><span class="cl">server2:~# ping 10.1.5.10
</span></span><span class="line"><span class="cl">PING 10.1.5.10 (10.1.5.10) 56(84) bytes of data.
</span></span><span class="line"><span class="cl">64 bytes from 10.1.5.10: icmp_seq=1 ttl=64 time=0.255 ms
</span></span><span class="line"><span class="cl">64 bytes from 10.1.5.10: icmp_seq=2 ttl=64 time=0.106 ms
</span></span><span class="line"><span class="cl">64 bytes from 10.1.5.10: icmp_seq=3 ttl=64 time=0.112 ms
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以发现ttl的值一直是64,表示网络走的是交换，如果走的路由，ttl会每走一次路由 -1</p>
<p>销毁</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">root@node4:~# ifconfig br-pool0 down
</span></span><span class="line"><span class="cl">root@node4:~# brctl delbr br-pool0
</span></span><span class="line"><span class="cl">clab destroy -t br.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="路由连接">路由连接</h3>
<p>创建vyos配置<code>gw0-boot.cfg</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">interfaces</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ethernet</span> <span class="n">eth1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">address</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">5.1</span><span class="o">/</span><span class="mi">24</span>  <span class="c1"># 设置接口 eth1 的 IP 地址和子网掩码</span>
</span></span><span class="line"><span class="cl">        <span class="n">duplex</span> <span class="n">auto</span>  <span class="c1"># 自动设置双工模式</span>
</span></span><span class="line"><span class="cl">        <span class="n">smp</span><span class="o">-</span><span class="n">affinity</span> <span class="n">auto</span>  <span class="c1"># 自动设置 SMP 亲和性</span>
</span></span><span class="line"><span class="cl">        <span class="n">speed</span> <span class="n">auto</span>  <span class="c1"># 自动设置速度</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ethernet</span> <span class="n">eth2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">address</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">8.1</span><span class="o">/</span><span class="mi">24</span>  <span class="c1"># 设置接口 eth2 的 IP 地址和子网掩码</span>
</span></span><span class="line"><span class="cl">        <span class="n">duplex</span> <span class="n">auto</span>  <span class="c1"># 自动设置双工模式</span>
</span></span><span class="line"><span class="cl">        <span class="n">smp</span><span class="o">-</span><span class="n">affinity</span> <span class="n">auto</span>  <span class="c1"># 自动设置 SMP 亲和性</span>
</span></span><span class="line"><span class="cl">        <span class="n">speed</span> <span class="n">auto</span>  <span class="c1"># 自动设置速度</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">loopback</span> <span class="n">lo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nat</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">source</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">rule</span> <span class="mi">100</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">outbound</span><span class="o">-</span><span class="n">interface</span> <span class="n">eth0</span>  <span class="c1"># 设置 NAT 出口接口为 eth0</span>
</span></span><span class="line"><span class="cl">            <span class="n">source</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">address</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">16</span>   <span class="c1"># 源地址为 10.1.0.0/16</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">translation</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">address</span> <span class="n">masquerade</span>  <span class="c1"># 使用地址伪装进行 NAT</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span><span class="o">-</span><span class="n">name</span> <span class="s2">&#34;vyos&#34;</span>  <span class="c1"># 设置主机名为 &#34;vyos&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">login</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="n">vyos</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">authentication</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">encrypted</span><span class="o">-</span><span class="n">password</span> <span class="s2">&#34;$6$QxPS.uk6mfo$9QBSo8u1FkH16gMyAVhus6fU3LOzvLR9Z9.82m3tiHFAxTtIkhaZSWssSgzt4v4dGAL8rhVQxTg0oAG9/q11h/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="n">plaintext</span><span class="o">-</span><span class="n">password</span> <span class="s2">&#34;&#34;</span>  <span class="c1"># 设置用户 vyos 的密码</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">level</span> <span class="s2">&#34;admin&#34;</span>  <span class="c1"># 用户权限级别为管理员</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">syslog</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">global</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">facility</span> <span class="n">all</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">level</span> <span class="s2">&#34;info&#34;</span>  <span class="c1"># 设置全局日志级别为 info</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">facility</span> <span class="n">protocols</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">level</span> <span class="s2">&#34;debug&#34;</span>  <span class="c1"># 设置协议日志级别为 debug</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ntp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;0.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;1.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;2.pool.ntp.org&#34;</span>  <span class="c1"># 配置 NTP 服务器</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="o">-</span><span class="n">management</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">commit</span><span class="o">-</span><span class="n">revisions</span> <span class="s2">&#34;100&#34;</span>  <span class="c1"># 保留最近 100 次配置更改</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">console</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">device</span> <span class="n">ttyS0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">speed</span> <span class="mi">9600</span>  <span class="c1"># 设置控制台速度为 9600</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">interfaces</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">loopback</span> <span class="s2">&#34;lo&#34;</span>  <span class="c1"># 设置回环接口 lo</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="n">Warning</span><span class="p">:</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">following</span> <span class="n">line</span><span class="o">.</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="o">===</span> <span class="n">vyatta</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">version</span><span class="p">:</span> <span class="s2">&#34;broadcast-relay@1:cluster@1:config-management@1:conntrack@1:conntrack-sync@1:dhcp-relay@2:dhcp-server@5:dns-forwarding@1:firewall@5:ipsec@5:l2tp@1:mdns@1:nat@4:ntp@1:pppoe-server@2:pptp@1:qos@1:quagga@7:snmp@1:ssh@1:system@10:vrrp@2:wanloadbalance@3:webgui@1:webproxy@1:zone-policy@1&#34;</span> <span class="o">===</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="n">Release</span> <span class="n">version</span><span class="p">:</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">8</span> <span class="o">*/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>拓扑</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">set</span> -v
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt; route.yaml | clab deploy -t route.yaml -
</span></span></span><span class="line"><span class="cl"><span class="s">name: routing 
</span></span></span><span class="line"><span class="cl"><span class="s">topology:
</span></span></span><span class="line"><span class="cl"><span class="s">  nodes:
</span></span></span><span class="line"><span class="cl"><span class="s">    gw0:       #gw0 是一个路由器配置
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: vyos/vyos:1.2.8
</span></span></span><span class="line"><span class="cl"><span class="s">      cmd: sbin/init
</span></span></span><span class="line"><span class="cl"><span class="s">      binds:
</span></span></span><span class="line"><span class="cl"><span class="s">        - /lib/modules:/lib/modules
</span></span></span><span class="line"><span class="cl"><span class="s">        - ./gw0-boot.cfg:/opt/vyatta/etc/config/config.boot
</span></span></span><span class="line"><span class="cl"><span class="s">    server1: 
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip route replace default via 10.1.5.1
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">    server2:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.8.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip route replace default via 10.1.8.1
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">  links:
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw0:eth1&#34;, &#34;server1:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw0:eth2&#34;, &#34;server2:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>创建完成</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">+---+----------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl">| # |         Name         | Container ID |       Image       | Kind  |  State  |  IPv4 Address  |     IPv6 Address     |
</span></span><span class="line"><span class="cl">+---+----------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl">| 1 | clab-routing-gw0     | c71e42b886ad | vyos/vyos:1.2.8   | linux | running | 172.20.20.4/24 | 2001:172:20:20::4/64 |
</span></span><span class="line"><span class="cl">| 2 | clab-routing-server1 | 68db0b748fd0 | nicolaka/netshoot | linux | running | 172.20.20.3/24 | 2001:172:20:20::3/64 |
</span></span><span class="line"><span class="cl">| 3 | clab-routing-server2 | 66bd60e72778 | nicolaka/netshoot | linux | running | 172.20.20.2/24 | 2001:172:20:20::2/64 |
</span></span><span class="line"><span class="cl">+---+----------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>验证, ttl会每走一次路由 -1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker exec -it 66bd60e72778 /bin/bash
</span></span><span class="line"><span class="cl">server2:~# ping 10.1.5.10
</span></span><span class="line"><span class="cl">PING 10.1.5.10 (10.1.5.10) 56(84) bytes of data.
</span></span><span class="line"><span class="cl">64 bytes from 10.1.5.10: icmp_seq=1 ttl=63 time=0.292 ms
</span></span><span class="line"><span class="cl">64 bytes from 10.1.5.10: icmp_seq=2 ttl=63 time=0.137 ms
</span></span><span class="line"><span class="cl">64 bytes from 10.1.5.10: icmp_seq=3 ttl=63 time=0.109 ms
</span></span></code></pre></td></tr></table>
</div>
</div><p>销毁</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">clab destroy -a
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="vxlan">vxlan</h3>
<p>准备拓扑文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">set</span> -v
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt; vxlan.yaml | clab deploy -t vxlan.yaml -
</span></span></span><span class="line"><span class="cl"><span class="s">name: vxlan
</span></span></span><span class="line"><span class="cl"><span class="s">topology:
</span></span></span><span class="line"><span class="cl"><span class="s">  nodes:
</span></span></span><span class="line"><span class="cl"><span class="s">    gw0:      
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: vyos/vyos:1.2.8
</span></span></span><span class="line"><span class="cl"><span class="s">      cmd: /sbin/init
</span></span></span><span class="line"><span class="cl"><span class="s">      binds:
</span></span></span><span class="line"><span class="cl"><span class="s">        - /lib/modules:/lib/modules
</span></span></span><span class="line"><span class="cl"><span class="s">        - ./gw0.cfg:/opt/vyatta/etc/config/config.boot
</span></span></span><span class="line"><span class="cl"><span class="s">        
</span></span></span><span class="line"><span class="cl"><span class="s">    gw1:      
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: vyos/vyos:1.2.8
</span></span></span><span class="line"><span class="cl"><span class="s">      cmd: /sbin/init
</span></span></span><span class="line"><span class="cl"><span class="s">      binds:
</span></span></span><span class="line"><span class="cl"><span class="s">        - /lib/modules:/lib/modules
</span></span></span><span class="line"><span class="cl"><span class="s">        - ./gw1.cfg:/opt/vyatta/etc/config/config.boot
</span></span></span><span class="line"><span class="cl"><span class="s">         
</span></span></span><span class="line"><span class="cl"><span class="s">    server1: 
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip route replace default via 10.1.5.1
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">    server2:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.8.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip route replace default via 10.1.8.1
</span></span></span><span class="line"><span class="cl"><span class="s">      
</span></span></span><span class="line"><span class="cl"><span class="s">  links:
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw0:eth1&#34;, &#34;server1:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw1:eth1&#34;, &#34;server2:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw0:eth2&#34;, &#34;gw1:eth2&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>路由配置文件</p>
<p><code>gw0.cfg  </code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">interfaces</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ethernet</span> <span class="n">eth1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">address</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">5.1</span><span class="o">/</span><span class="mi">24</span>  
</span></span><span class="line"><span class="cl">    	<span class="n">duplex</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">smp</span><span class="o">-</span><span class="n">affinity</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">speed</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">ethernet</span> <span class="n">eth2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">address</span> <span class="mf">172.12</span><span class="o">.</span><span class="mf">1.10</span><span class="o">/</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl">    	<span class="n">duplex</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">smp</span><span class="o">-</span><span class="n">affinity</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">speed</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">loopback</span> <span class="n">lo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">vxlan</span> <span class="n">vxlan0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">address</span> <span class="mf">1.1</span><span class="o">.</span><span class="mf">1.1</span><span class="o">/</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl">        <span class="n">remote</span> <span class="mf">172.12</span><span class="o">.</span><span class="mf">1.11</span>
</span></span><span class="line"><span class="cl">        <span class="n">vni</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">protocols</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">route</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">8.0</span><span class="o">/</span><span class="mi">24</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    		<span class="n">next</span><span class="o">-</span><span class="n">hop</span> <span class="mf">1.1</span><span class="o">.</span><span class="mf">1.2</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span><span class="o">-</span><span class="n">name</span> <span class="s2">&#34;vyos&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">login</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="n">vyos</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">authentication</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">encrypted</span><span class="o">-</span><span class="n">password</span> <span class="s2">&#34;$6$QxPS.uk6mfo$9QBSo8u1FkH16gMyAVhus6fU3LOzvLR9Z9.82m3tiHFAxTtIkhaZSWssSgzt4v4dGAL8rhVQxTg0oAG9/q11h/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="n">plaintext</span><span class="o">-</span><span class="n">password</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">level</span> <span class="s2">&#34;admin&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">syslog</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">global</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">facility</span> <span class="n">all</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">level</span> <span class="s2">&#34;info&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">facility</span> <span class="n">protocols</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">level</span> <span class="s2">&#34;debug&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ntp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;0.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;1.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;2.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="o">-</span><span class="n">management</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">commit</span><span class="o">-</span><span class="n">revisions</span> <span class="s2">&#34;100&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">console</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">device</span> <span class="n">ttyS0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">speed</span> <span class="mi">9600</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">interfaces</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">loopback</span> <span class="s2">&#34;lo&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="n">Warning</span><span class="p">:</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">following</span> <span class="n">line</span><span class="o">.</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="o">===</span> <span class="n">vyatta</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">version</span><span class="p">:</span> <span class="s2">&#34;broadcast-relay@1:cluster@1:config-management@1:conntrack@1:conntrack-sync@1:dhcp-relay@2:dhcp-server@5:dns-forwarding@1:firewall@5:ipsec@5:l2tp@1:mdns@1:nat@4:ntp@1:pppoe-server@2:pptp@1:qos@1:quagga@7:snmp@1:ssh@1:system@10:vrrp@2:wanloadbalance@3:webgui@1:webproxy@1:zone-policy@1&#34;</span> <span class="o">===</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="n">Release</span> <span class="n">version</span><span class="p">:</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">8</span> <span class="o">*/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>gw1.cfg</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">interfaces</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ethernet</span> <span class="n">eth1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">address</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">8.1</span><span class="o">/</span><span class="mi">24</span>  
</span></span><span class="line"><span class="cl">    	<span class="n">duplex</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">smp</span><span class="o">-</span><span class="n">affinity</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">speed</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">ethernet</span> <span class="n">eth2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">address</span> <span class="mf">172.12</span><span class="o">.</span><span class="mf">1.11</span><span class="o">/</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl">    	<span class="n">duplex</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">smp</span><span class="o">-</span><span class="n">affinity</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">    	<span class="n">speed</span> <span class="n">auto</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">loopback</span> <span class="n">lo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">vxlan</span> <span class="n">vxlan0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">address</span> <span class="mf">1.1</span><span class="o">.</span><span class="mf">1.2</span><span class="o">/</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl">        <span class="n">remote</span> <span class="mf">172.12</span><span class="o">.</span><span class="mf">1.10</span>
</span></span><span class="line"><span class="cl">        <span class="n">vni</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">protocols</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">route</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">5.0</span><span class="o">/</span><span class="mi">24</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    		<span class="n">next</span><span class="o">-</span><span class="n">hop</span> <span class="mf">1.1</span><span class="o">.</span><span class="mf">1.1</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span><span class="o">-</span><span class="n">name</span> <span class="s2">&#34;vyos&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">login</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="n">vyos</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">authentication</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">encrypted</span><span class="o">-</span><span class="n">password</span> <span class="s2">&#34;$6$QxPS.uk6mfo$9QBSo8u1FkH16gMyAVhus6fU3LOzvLR9Z9.82m3tiHFAxTtIkhaZSWssSgzt4v4dGAL8rhVQxTg0oAG9/q11h/&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="n">plaintext</span><span class="o">-</span><span class="n">password</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">level</span> <span class="s2">&#34;admin&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">syslog</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">global</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">facility</span> <span class="n">all</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">level</span> <span class="s2">&#34;info&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">facility</span> <span class="n">protocols</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">level</span> <span class="s2">&#34;debug&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ntp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;0.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;1.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server</span> <span class="s2">&#34;2.pool.ntp.org&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="o">-</span><span class="n">management</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">commit</span><span class="o">-</span><span class="n">revisions</span> <span class="s2">&#34;100&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">console</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">device</span> <span class="n">ttyS0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">speed</span> <span class="mi">9600</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">interfaces</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">loopback</span> <span class="s2">&#34;lo&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="n">Warning</span><span class="p">:</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">following</span> <span class="n">line</span><span class="o">.</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="o">===</span> <span class="n">vyatta</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">version</span><span class="p">:</span> <span class="s2">&#34;broadcast-relay@1:cluster@1:config-management@1:conntrack@1:conntrack-sync@1:dhcp-relay@2:dhcp-server@5:dns-forwarding@1:firewall@5:ipsec@5:l2tp@1:mdns@1:nat@4:ntp@1:pppoe-server@2:pptp@1:qos@1:quagga@7:snmp@1:ssh@1:system@10:vrrp@2:wanloadbalance@3:webgui@1:webproxy@1:zone-policy@1&#34;</span> <span class="o">===</span> <span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">/*</span> <span class="n">Release</span> <span class="n">version</span><span class="p">:</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">8</span> <span class="o">*/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">clab inspect -t vxlan.yaml 
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0000<span class="o">]</span> Parsing <span class="p">&amp;</span> checking topology file: vxlan.yaml 
</span></span><span class="line"><span class="cl">+---+--------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="c1"># |        Name        | Container ID |       Image       | Kind  |  State  |  IPv4 Address  |     IPv6 Address     |</span>
</span></span><span class="line"><span class="cl">+---+--------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">1</span> <span class="p">|</span> clab-vxlan-gw0     <span class="p">|</span> 6117c8f4a823 <span class="p">|</span> vyos/vyos:1.2.8   <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.3/24 <span class="p">|</span> 2001:172:20:20::3/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">2</span> <span class="p">|</span> clab-vxlan-gw1     <span class="p">|</span> 4b7510fc2a27 <span class="p">|</span> vyos/vyos:1.2.8   <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.2/24 <span class="p">|</span> 2001:172:20:20::2/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">3</span> <span class="p">|</span> clab-vxlan-server1 <span class="p">|</span> 548291d7e5bd <span class="p">|</span> nicolaka/netshoot <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.5/24 <span class="p">|</span> 2001:172:20:20::5/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">4</span> <span class="p">|</span> clab-vxlan-server2 <span class="p">|</span> 8b4c72fe856a <span class="p">|</span> nicolaka/netshoot <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.4/24 <span class="p">|</span> 2001:172:20:20::4/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---+--------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ping 10.1.8.10
</span></span><span class="line"><span class="cl">PING 10.1.8.10 (10.1.8.10) 56(84) bytes of data.
</span></span><span class="line"><span class="cl">64 bytes from 10.1.8.10: icmp_seq=1 ttl=62 time=0.197 ms
</span></span><span class="line"><span class="cl">64 bytes from 10.1.8.10: icmp_seq=2 ttl=62 time=0.068 ms
</span></span></code></pre></td></tr></table>
</div>
</div><p>ttl值 <code>-2</code> 与我们的拓扑一致</p>
<h3 id="host-gw">Host-gw</h3>
<p>路由配置文件</p>
<p><code>gw0.cfg  </code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">interfaces <span class="o">{</span>
</span></span><span class="line"><span class="cl">    ethernet eth1 <span class="o">{</span>
</span></span><span class="line"><span class="cl">        address 10.1.5.1/24
</span></span><span class="line"><span class="cl">        duplex auto
</span></span><span class="line"><span class="cl">        smp-affinity auto
</span></span><span class="line"><span class="cl">        speed auto
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    ethernet eth2 <span class="o">{</span>
</span></span><span class="line"><span class="cl">        address 172.12.1.10/24
</span></span><span class="line"><span class="cl">        duplex auto
</span></span><span class="line"><span class="cl">        smp-affinity auto
</span></span><span class="line"><span class="cl">        speed auto
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    loopback lo <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">protocols <span class="o">{</span>
</span></span><span class="line"><span class="cl">    static <span class="o">{</span>
</span></span><span class="line"><span class="cl">        route 10.1.8.0/24 <span class="o">{</span>
</span></span><span class="line"><span class="cl">            next-hop 172.12.1.11 <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">system <span class="o">{</span>
</span></span><span class="line"><span class="cl">    config-management <span class="o">{</span>
</span></span><span class="line"><span class="cl">        commit-revisions <span class="m">100</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    console <span class="o">{</span>
</span></span><span class="line"><span class="cl">        device ttyS0 <span class="o">{</span>
</span></span><span class="line"><span class="cl">            speed <span class="m">9600</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    host-name vyos
</span></span><span class="line"><span class="cl">    login <span class="o">{</span>
</span></span><span class="line"><span class="cl">        user vyos <span class="o">{</span>
</span></span><span class="line"><span class="cl">            authentication <span class="o">{</span>
</span></span><span class="line"><span class="cl">                encrypted-password <span class="nv">$6$QxPS</span>.uk6mfo<span class="nv">$9</span>QBSo8u1FkH16gMyAVhus6fU3LOzvLR9Z9.82m3tiHFAxTtIkhaZSWssSgzt4v4dGAL8rhVQxTg0oAG9/q11h/
</span></span><span class="line"><span class="cl">                plaintext-password <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            level admin
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    ntp <span class="o">{</span>
</span></span><span class="line"><span class="cl">        server 0.pool.ntp.org <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        server 1.pool.ntp.org <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        server 2.pool.ntp.org <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    syslog <span class="o">{</span>
</span></span><span class="line"><span class="cl">        global <span class="o">{</span>
</span></span><span class="line"><span class="cl">            facility all <span class="o">{</span>
</span></span><span class="line"><span class="cl">                level info
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            facility protocols <span class="o">{</span>
</span></span><span class="line"><span class="cl">                level debug
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    time-zone UTC
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/* Warning: Do not remove the following line. */
</span></span><span class="line"><span class="cl">/* <span class="o">===</span> vyatta-config-version: <span class="s2">&#34;dns-forwarding@1:mdns@1:ssh@1:webproxy@1:webgui@1:zone-policy@1:broadcast-relay@1:l2tp@1:cluster@1:snmp@1:pppoe-server@2:conntrack@1:wanloadbalance@3:webproxy@2:firewall@5:ntp@1:dhcp-server@5:dhcp-relay@2:system@10:nat@4:quagga@7:qos@1:ipsec@5:conntrack-sync@1:config-management@1:vrrp@2:pptp@1&#34;</span> <span class="o">===</span> */
</span></span><span class="line"><span class="cl">/* Release version: 1.2.8 */
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>gw1.cfg  </code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">interfaces <span class="o">{</span>
</span></span><span class="line"><span class="cl">    ethernet eth1 <span class="o">{</span>
</span></span><span class="line"><span class="cl">        address 10.1.8.1/24
</span></span><span class="line"><span class="cl">        duplex auto
</span></span><span class="line"><span class="cl">        smp-affinity auto
</span></span><span class="line"><span class="cl">        speed auto
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    ethernet eth2 <span class="o">{</span>
</span></span><span class="line"><span class="cl">        address 172.12.1.11/24
</span></span><span class="line"><span class="cl">        duplex auto
</span></span><span class="line"><span class="cl">        smp-affinity auto
</span></span><span class="line"><span class="cl">        speed auto
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    loopback lo <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">protocols <span class="o">{</span>
</span></span><span class="line"><span class="cl">    static <span class="o">{</span>
</span></span><span class="line"><span class="cl">        route 10.1.5.0/24 <span class="o">{</span>
</span></span><span class="line"><span class="cl">            next-hop 172.12.1.10 <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">system <span class="o">{</span>
</span></span><span class="line"><span class="cl">    config-management <span class="o">{</span>
</span></span><span class="line"><span class="cl">        commit-revisions <span class="m">100</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    console <span class="o">{</span>
</span></span><span class="line"><span class="cl">        device ttyS0 <span class="o">{</span>
</span></span><span class="line"><span class="cl">            speed <span class="m">9600</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    host-name vyos
</span></span><span class="line"><span class="cl">    login <span class="o">{</span>
</span></span><span class="line"><span class="cl">        user vyos <span class="o">{</span>
</span></span><span class="line"><span class="cl">            authentication <span class="o">{</span>
</span></span><span class="line"><span class="cl">                encrypted-password <span class="nv">$6$QxPS</span>.uk6mfo<span class="nv">$9</span>QBSo8u1FkH16gMyAVhus6fU3LOzvLR9Z9.82m3tiHFAxTtIkhaZSWssSgzt4v4dGAL8rhVQxTg0oAG9/q11h/
</span></span><span class="line"><span class="cl">                plaintext-password <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            level admin
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    ntp <span class="o">{</span>
</span></span><span class="line"><span class="cl">        server 0.pool.ntp.org <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        server 1.pool.ntp.org <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        server 2.pool.ntp.org <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    syslog <span class="o">{</span>
</span></span><span class="line"><span class="cl">        global <span class="o">{</span>
</span></span><span class="line"><span class="cl">            facility all <span class="o">{</span>
</span></span><span class="line"><span class="cl">                level info
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            facility protocols <span class="o">{</span>
</span></span><span class="line"><span class="cl">                level debug
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    time-zone UTC
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/* Warning: Do not remove the following line. */
</span></span><span class="line"><span class="cl">/* <span class="o">===</span> vyatta-config-version: <span class="s2">&#34;dns-forwarding@1:mdns@1:ssh@1:webproxy@1:webgui@1:zone-policy@1:broadcast-relay@1:l2tp@1:cluster@1:snmp@1:pppoe-server@2:conntrack@1:wanloadbalance@3:webproxy@2:firewall@5:ntp@1:dhcp-server@5:dhcp-relay@2:system@10:nat@4:quagga@7:qos@1:ipsec@5:conntrack-sync@1:config-management@1:vrrp@2:pptp@1&#34;</span> <span class="o">===</span> */
</span></span><span class="line"><span class="cl">/* Release version: 1.2.8 */
</span></span></code></pre></td></tr></table>
</div>
</div><p>拓扑文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">set</span> -v
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;clab.yaml | clab deploy -t clab.yaml -
</span></span></span><span class="line"><span class="cl"><span class="s">name: host-gw
</span></span></span><span class="line"><span class="cl"><span class="s">topology:
</span></span></span><span class="line"><span class="cl"><span class="s">  nodes:
</span></span></span><span class="line"><span class="cl"><span class="s">    gw0:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: vyos/vyos:1.2.8
</span></span></span><span class="line"><span class="cl"><span class="s">      cmd: /sbin/init
</span></span></span><span class="line"><span class="cl"><span class="s">      binds:
</span></span></span><span class="line"><span class="cl"><span class="s">        - /lib/modules:/lib/modules
</span></span></span><span class="line"><span class="cl"><span class="s">        - ./gw0.cfg:/opt/vyatta/etc/config/config.boot
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    gw1:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: vyos/vyos:1.2.8
</span></span></span><span class="line"><span class="cl"><span class="s">      cmd: /sbin/init
</span></span></span><span class="line"><span class="cl"><span class="s">      binds:
</span></span></span><span class="line"><span class="cl"><span class="s">        - /lib/modules:/lib/modules
</span></span></span><span class="line"><span class="cl"><span class="s">        - ./gw1.cfg:/opt/vyatta/etc/config/config.boot
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    server1:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.5.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip route replace default via 10.1.5.1
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">    server2:
</span></span></span><span class="line"><span class="cl"><span class="s">      kind: linux
</span></span></span><span class="line"><span class="cl"><span class="s">      image: nicolaka/netshoot
</span></span></span><span class="line"><span class="cl"><span class="s">      exec:
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip addr add 10.1.8.10/24 dev net0
</span></span></span><span class="line"><span class="cl"><span class="s">      - ip route replace default via 10.1.8.1
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">  links:
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw0:eth1&#34;, &#34;server1:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw1:eth1&#34;, &#34;server2:net0&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">    - endpoints: [&#34;gw0:eth2&#34;, &#34;gw1:eth2&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">+---+----------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="c1"># |         Name         | Container ID |       Image       | Kind  |  State  |  IPv4 Address  |     IPv6 Address     |</span>
</span></span><span class="line"><span class="cl">+---+----------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">1</span> <span class="p">|</span> clab-host-gw-gw0     <span class="p">|</span> 892b57b00d5d <span class="p">|</span> vyos/vyos:1.2.8   <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.2/24 <span class="p">|</span> 2001:172:20:20::2/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">2</span> <span class="p">|</span> clab-host-gw-gw1     <span class="p">|</span> fa6639c5595d <span class="p">|</span> vyos/vyos:1.2.8   <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.5/24 <span class="p">|</span> 2001:172:20:20::5/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">3</span> <span class="p">|</span> clab-host-gw-server1 <span class="p">|</span> 9206cb86e84d <span class="p">|</span> nicolaka/netshoot <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.3/24 <span class="p">|</span> 2001:172:20:20::3/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="m">4</span> <span class="p">|</span> clab-host-gw-server2 <span class="p">|</span> 42427237d60f <span class="p">|</span> nicolaka/netshoot <span class="p">|</span> linux <span class="p">|</span> running <span class="p">|</span> 172.20.20.4/24 <span class="p">|</span> 2001:172:20:20::4/64 <span class="p">|</span>
</span></span><span class="line"><span class="cl">+---+----------------------+--------------+-------------------+-------+---------+----------------+----------------------+
</span></span><span class="line"><span class="cl">root@node4:~/hgw# docker <span class="nb">exec</span> -it 9206cb86e84d /bin/bash
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it 9206cb86e84d /bin/bash
</span></span><span class="line"><span class="cl">server1:~# ping 10.1.8.10
</span></span><span class="line"><span class="cl">PING 10.1.8.10 <span class="o">(</span>10.1.8.10<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.1.8.10: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">62</span> <span class="nv">time</span><span class="o">=</span>0.270 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.1.8.10: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">62</span> <span class="nv">time</span><span class="o">=</span>0.186 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.1.8.10: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">62</span> <span class="nv">time</span><span class="o">=</span>0.125 ms
</span></span><span class="line"><span class="cl">^C
</span></span><span class="line"><span class="cl">--- 10.1.8.10 ping statistics ---
</span></span><span class="line"><span class="cl"><span class="m">3</span> packets transmitted, <span class="m">3</span> received, 0% packet loss, <span class="nb">time</span> 2038ms
</span></span><span class="line"><span class="cl">rtt min/avg/max/mdev <span class="o">=</span> 0.125/0.193/0.270/0.059 ms
</span></span></code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
        
        <nav class="post-nav">
            <a class="prev" href="/post/%E5%8A%AB%E6%8C%81docker.io%E5%88%B0%E9%95%9C%E5%83%8F%E6%BA%90/">
                <i class="iconfont icon-left"></i>
                <span class="prev-text nav-default">劫持docker.io到镜像源</span>
                <span class="prev-text nav-mobile">上一篇</span>
            </a>
            <a class="next" href="/post/%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E9%87%8D%E5%90%AF%E5%89%8D%E6%97%A5%E5%BF%97/">
                <span class="next-text nav-default">查看容器重启前日志</span>
                <span class="next-text nav-mobile">下一篇</span>
                <i class="iconfont icon-right"></i>
            </a>
        </nav>
    </footer>
</article>
        </div>
        

  

  

  
  

      </div>
    </main>

    <footer id="footer" class="footer">
      
<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 -
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy;
    2022 -
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>inksnw</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"  crossorigin="anonymous"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/slideout/1.0.1/slideout.min.js"  crossorigin="anonymous"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>






<script src="/js/scripts.js"></script>


</body>
</html>
